// The first two convolutional layers of deepspeech2.
//
// We tack on a FC layer at the end to make it easier to compare correct soft
// labels, as the output of the convolution can be in many different data
// layouts.

network {
  name = "deepspeech"
  input_rows = 161
  input_cols = 126
  input_height = 1

  layer conv0 {
    type = CONVOLUTION
    activation = HARD_TANH
    convolution_param {
      num_output = 32
      kernel_rows = 41
      kernel_cols = 11
      stride = 2
      padding = VALID
    }
  }

  layer conv1 {
    type = CONVOLUTION
    activation = HARD_TANH
    convolution_param {
      num_output = 32
      kernel_rows = 21
      kernel_cols = 11
      row_stride = 2
      col_stride = 1
      padding = VALID
    }
  }

  layer fc {
    type = INNER_PRODUCT
    inner_product_param {
      num_output = 100
    }
  }
}
