// A network that uses activation functions SMIV doesn't support.

network {
  name = "cnn"
  input_rows = 16
  input_cols = 16
  input_height = 1

  layer conv0 {
    type = CONVOLUTION
    activation = SIGMOID
    convolution_param {
      num_output = 1
      kernel_size = 3
      stride = 1
      padding = SAME
    }
  }

  layer pool0 {
    type = POOLING
    activation = HARD_TANH
    pooling_param {
      pool = MAX
      size = 2
      stride = 2
    }
  }

  // Final layer to produce output.
  layer fc5 {
    type = INNER_PRODUCT
    inner_product_param {
      num_output = 10
    }
  }
}

device {
  cpu_default_offload = DMA
  cpu_activation_func_offload = ACP
  cpu_pooling_offload = DMA
  use_hw_pooling = true
  use_hw_batch_norm = true
}
