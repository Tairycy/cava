// The final network topology chosen for Minerva.

network {
  name = "minerva"
  input_rows = 28
  input_cols = 28
  input_height = 1

  layer fc0 {
    type = INNER_PRODUCT
    activation = "RELU"
    inner_product_param {
      num_output = 256
    }
  }

  layer bn {
    type = BATCH_NORM
  }

  layer fc1 {
    type = INNER_PRODUCT
    activation = "RELU"
    inner_product_param {
      num_output = 256
    }
  }

  layer fc2 {
    type = INNER_PRODUCT
    activation = "RELU"
    inner_product_param {
      num_output = 256
    }
  }

  layer fc3 {
    type = INNER_PRODUCT
    inner_product_param {
      num_output = 10
    }
  }
}

device {
  use_hw_pooling = true
  use_hw_batch_norm = true
}
